#include <iostream>
#include <cstdlib>
#include <random>


using namespace std;


//returns the index of the 1dim where the 2dim element would be stored
int LinearIndx(int a, int b){
    return (a*(a+1))*0.5 +b;
}

int getSizeOfB(int row){
    return (0.5)*(row*row+row);
}


//returns the indices of the 2dim where the 1dim element would be written into
int* InverseIndx(int d){
    int c;
    int* indices = (int*) malloc(sizeof(int)*2);
    for(int i=1;i<=d;i++){
        for(int j=0;j<=i;j++){
            c++;
            if(c==d){
                indices[0]=i;
                indices[1]=j;
            }
        }
    }
    return indices;
}





void doOperations(int row, int numberOfItemsToShow){
    int a[row][row];

    random_device rd;

    //initializing random values for lower triangular matrix.
    for(int m=0; m<row;m++)
    {
        for(int n=0;n<=m;n++)
        {
            a[m][n]=rd()%1000;
        }
    }
    
    int s=0;
    cout<<"Lower triangular matrix A[][] \n"<<endl;
    for(int e=0;e<row;e++){
        for(int f=0;f<=e;f++){
            s++;
            cout<<a[e][f]<<" ";
            if(s==numberOfItemsToShow) break;
        }
        cout<<endl;
        if(s==numberOfItemsToShow) break;
    }

    cout<<"\nPrinting Indices of A[][] matrix"<<endl;
    s=0;
    for(int e=0;e<row;e++){
        for(int f=0;f<=e;f++){
            s++;
            cout<<"("<<e<<","<<f<<")";
            if(s==numberOfItemsToShow) break;
        }
        if(s==numberOfItemsToShow) break;
    }


    int b[getSizeOfB(row)]; 

    int len_b= sizeof(b)/sizeof(b[0]);

    //assigning 2D elements to 1D    
    for(int i=0;i<row;i++){
        for(int j=0;j<=i;j++){
            int index = LinearIndx(i,j); 
            b[index]=a[i][j];  
        }
    }

    //assigning 1D elements back to 2D
    int arr_c[row][row];
    for(int k=0; k<len_b;k++){
        int* arr= InverseIndx(k);
        int i = arr[0];
        int j = arr[1];

        arr_c[i][j]=b[k];
        free(arr); //to avoid leakage, we need to free the arr pointer.
    }

    cout<<"\n\nFirst "<<numberOfItemsToShow<<" elements of 1 dimensional B[]"<<endl<<"[";
    for(int l=0;l<numberOfItemsToShow;l++){
        cout<<b[l]<<" ";
    }
    cout<<"]"; 

    cout<<"\n\nLower triangular matrix C[][] - first n elements"<<endl;
    int c=0;
    for(int m=0;m<row;m++)
    {
        cout<<"\n";
        for(int n=0;n<=m;n++){
            c++;
            cout<<arr_c[m][n]<<" ";
            if(c==numberOfItemsToShow) break;
        }
        if(c==numberOfItemsToShow) break;
    }

    cin.get(); //to capture blank screen.
}


int main(){ 
    
    int row;
    int n;

    cout<<"Enter the rows of your square matrix: ";
    cin>>row;

    cout<<"Enter the number of element you want to show: ";
    cin>>n;
    
    doOperations(row,n);

    cin.get();
}
